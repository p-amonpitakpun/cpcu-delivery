(this["webpackJsonpsenior-frontend"]=this["webpackJsonpsenior-frontend"]||[]).push([[0],{14:function(t,e,a){t.exports={Page:"style_Page__1J22r",Box:"style_Box__yrZPo",Robot:"style_Robot__1aAbD",HeadText:"style_HeadText__3vMN5",typing:"style_typing__22jCa","blink-caret":"style_blink-caret__1O4bU",HeadTextWrong:"style_HeadTextWrong__1Y6m1",typing2:"style_typing2__1nGmE",HeadTextPass:"style_HeadTextPass__1pKzl",typing3:"style_typing3__1kl4R",textinput:"style_textinput__2nqW_",submit:"style_submit__3EEMG"}},2:function(t,e,a){t.exports={Page:"style_Page__3lO_-",Beautifulmap:"style_Beautifulmap__1VnyD",currentPos:"style_currentPos__3kHNH",columnContainer:"style_columnContainer__Nq6Aw",logout:"style_logout__WqGgL",namebox:"style_namebox__Zz_KD",name:"style_name__eptz7",debug:"style_debug__1_nzi",debug2:"style_debug2__1UosV",toggleButton:"style_toggleButton__3bRhi",right:"style_right__3m7Vc",toggleDot:"style_toggleDot__2IX_X",togglePane:"style_togglePane__2fEDe",secHead:"style_secHead__1LBo2",currentClick:"style_currentClick__1M8ll",targetClick:"style_targetClick__2HQyJ",targetPath:"style_targetPath__XqbWP",statusText:"style_statusText__1VnBN",greenText:"style_greenText__32yGO",yellowText:"style_yellowText__1w9gn",greyText:"style_greyText__1krqe",blueText:"style_blueText__18sU_",statusBox:"style_statusBox__34BN8"}},95:function(t,e,a){},96:function(t,e,a){"use strict";a.r(e);var s=a(1),n=a.n(s),c=a(52),r=a.n(c),o=a(23),i=a(3),u=a(5),l=a.n(u),d=a(15),p=a(24),b=a(25),_=a(27),j=a(26),h=a(14),x=a.n(h),m=a.p+"static/media/robot.d00afd71.png",g=function(){return localStorage.getItem("auth")},f={sendPost:function(){var t=Object(d.a)(l.a.mark((function t(e,a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("/api/").concat(e),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"JWT ".concat(g())},body:JSON.stringify(a)});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),sendGet:function(){var t=Object(d.a)(l.a.mark((function t(e,a){var s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=new URL("".concat("/api/").concat(e)),a&&Object.keys(a).forEach((function(t){return s.searchParams.append(t,a[t])})),t.next=4,fetch(s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"JWT ".concat(g())}});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},y=a(0),O=function(t){Object(_.a)(a,t);var e=Object(j.a)(a);function a(){var t;Object(p.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(t=e.call.apply(e,[this].concat(n))).state={status:0,username:"",password:""},t.renderHead=function(){return 0===t.state.status?Object(y.jsx)("div",{className:x.a.HeadText,children:'"Who ..  are .. you .. ?"'}):1===t.state.status?Object(y.jsx)("div",{className:x.a.HeadTextWrong,children:'"Wrong .. Credential .. !"'}):2===t.state.status?Object(y.jsx)("div",{className:x.a.HeadTextPass,children:'"Welcome .. :)"'}):void 0},t.submitLogin=function(){var e=Object(d.a)(l.a.mark((function e(a){var s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,f.sendPost("auth",{username:t.state.username,password:t.state.password});case 3:if(200===(s=e.sent).status){e.next=8;break}t.setState({status:1}),e.next=14;break;case 8:return e.next=10,s.json();case 10:n=e.sent,localStorage.setItem("auth",n.token),t.setState({status:2}),setTimeout((function(){t.props.history.push("/robot")}),3e3);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.handleText=function(e,a){var s={};s[a]=e.currentTarget.value,t.setState(s)},t.loginResult=function(t,e){return t===e},t}return Object(b.a)(a,[{key:"componentDidMount",value:function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.sendGet("whoami",{a:"b"});case 2:200===t.sent.status&&this.props.history.push("/robot");case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(y.jsx)("div",{className:x.a.Page,children:Object(y.jsxs)("div",{className:x.a.Box,children:[Object(y.jsx)("img",{src:m,className:x.a.Robot}),this.renderHead(),2!==this.state.status&&Object(y.jsxs)("form",{onSubmit:this.submitLogin,children:[Object(y.jsx)("input",{placeholder:"Username",onChange:function(e){return t.handleText(e,"username")},value:this.state.username,type:"text",className:x.a.textinput}),Object(y.jsx)("input",{placeholder:"Password",onChange:function(e){return t.handleText(e,"password")},value:this.state.password,type:"password",className:x.a.textinput}),Object(y.jsx)("input",{type:"submit",className:x.a.submit,value:"Enter"})]})]})})}}]),a}(n.a.Component),v=Object(i.f)(O),k=a(2),N=a.n(k),T=a.p+"static/media/map.62b800f7.png",C=a(54),w={1:[112,63],2:[37,223],3:[55,407],4:[447,256],5:[294,99],6:[255,429]},P=function(t){Object(_.a)(a,t);var e=Object(j.a)(a);function a(){var t;Object(p.a)(this,a);for(var s=arguments.length,c=new Array(s),r=0;r<s;r++)c[r]=arguments[r];return(t=e.call.apply(e,[this].concat(c))).state={maptype:0,occupancy_map:"",current_user:null,clicked_coordinate:[0,0],robot_current_state:{status:0,position:[0,0],target:null,path:[],user:"User1"},socket:null},t.controlpanel=function(){return 0===t.state.robot_current_state.status?Object(y.jsxs)(n.a.Fragment,{children:[Object(y.jsx)("div",{children:"Basic control(specify room)"}),Object(y.jsx)("div",{children:"Move to Room"}),Object(y.jsx)("select",{children:t.roomoptions()}),Object(y.jsx)("button",{children:"Go"}),Object(y.jsx)("div",{children:"Advanced control(specify coordinate)"}),Object(y.jsx)("div",{children:"Click on the map the point to get coordinate"}),Object(y.jsxs)("div",{children:["X: ",t.state.clicked_coordinate[0]]}),Object(y.jsxs)("div",{children:["Y: ",t.state.clicked_coordinate[1]]}),Object(y.jsx)("button",{onClick:t.move,children:"Go"})]}):1===t.state.robot_current_state.status?Object(y.jsxs)(n.a.Fragment,{children:[Object(y.jsx)("div",{children:"Pause or cancel"}),Object(y.jsx)("button",{onClick:t.pause,children:"Pause"}),Object(y.jsx)("button",{onClick:t.stop,children:"Stop/Cancel"})]}):2===t.state.robot_current_state.status?Object(y.jsxs)(n.a.Fragment,{children:[Object(y.jsx)("div",{children:"Resume or cancel"}),Object(y.jsx)("button",{children:"Resume"}),Object(y.jsx)("button",{onClick:t.stop,children:"Stop/Cancel"})]}):void 0},t.roomoptions=function(){return Object.keys(w).map((function(t){return Object(y.jsx)("option",{label:t,value:t,children:t},t)}))},t.clickMap=function(e){var a=e.currentTarget.getBoundingClientRect(),s=Math.round(e.clientX-a.left),n=Math.round(e.clientY-a.top);t.setState({clicked_coordinate:[s,n]})},t.logOut=function(){localStorage.removeItem("auth"),t.props.history.push("/")},t.renderInsideMap=function(){return Object(y.jsxs)(n.a.Fragment,{children:[Object(y.jsx)("img",{src:m,className:N.a.currentPos,style:{top:"".concat(t.state.robot_current_state.position[1]-20,"px"),left:"".concat(t.state.robot_current_state.position[0]-20,"px")}}),0===t.state.robot_current_state.status&&Object(y.jsx)("div",{className:N.a.currentClick,style:{top:"".concat(t.state.clicked_coordinate[1]-5,"px"),left:"".concat(t.state.clicked_coordinate[0]-5,"px")}}),1===t.state.robot_current_state.status&&Object(y.jsx)("div",{className:N.a.targetClick,style:{top:"".concat(t.state.robot_current_state.target[1]-5,"px"),left:"".concat(t.state.robot_current_state.target[0]-5,"px")}}),1===t.state.robot_current_state.status&&t.renderPath()]})},t.renderPath=function(){for(var e=[],a=0;a<t.state.robot_current_state.path.length;a++)e.push(Object(y.jsx)("div",{className:N.a.targetPath,style:{left:"".concat(t.state.robot_current_state.path[a][0]-5,"px"),top:"".concat(t.state.robot_current_state.path[a][1]-5,"px")}}));return e},t.move=function(){t.state.socket.emit("moveCommand",{destination:t.state.clicked_coordinate})},t.stop=function(){t.state.socket.emit("stopCommand")},t.pause=function(){t.state.socket.emit("pauseCommand")},t}return Object(b.a)(a,[{key:"componentDidMount",value:function(){var t=Object(d.a)(l.a.mark((function t(){var e,a=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=Object(C.io)("/",{query:{token:localStorage.getItem("auth")}})).on("401",(function(){a.logOut()})),e.on("authenticated",(function(t){a.setState({current_user:t})})),e.on("robotState",(function(t){var e=t.planning_state,s=a.state.robot_current_state;s.position=t.occupancy_grid_position,s.status=e.state,s.target=e.target,s.path=e.path,a.setState({occupancy_map:"data:image/png;base64, ".concat(t.map.replace(/(\r\n|\n|\r)/gm,"")),robot_current_state:s})})),this.setState({socket:e});case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.state.socket.disconnect();case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(y.jsxs)("div",{className:N.a.Page,children:[Object(y.jsxs)("div",{className:N.a.namebox,children:["Welcome, ",Object(y.jsx)("b",{className:N.a.name,children:this.state.current_user})," ",Object(y.jsx)("div",{className:N.a.logout,onClick:this.logOut,children:"logout"})]}),Object(y.jsx)("hr",{}),Object(y.jsxs)("div",{className:N.a.columnContainer,children:[Object(y.jsxs)("div",{className:N.a.debug,children:[Object(y.jsx)("div",{className:N.a.secHead,children:"Robot Status"}),Object(y.jsxs)("div",{className:N.a.statusBox,children:[Object(y.jsx)("b",{className:N.a.statusText,children:"Status:"}),0===this.state.robot_current_state.status&&Object(y.jsx)("b",{className:N.a.greyText,children:"Idle"}),1===this.state.robot_current_state.status&&Object(y.jsx)("b",{className:N.a.greenText,children:"Moving"}),2===this.state.robot_current_state.status&&Object(y.jsx)("b",{className:N.a.yellowText,children:"Paused"})]}),0!==this.state.robot_current_state.status&&Object(y.jsxs)("div",{className:N.a.statusBox,children:[Object(y.jsx)("b",{className:N.a.statusText,children:"By user:"}),0!==this.state.robot_current_state.status&&Object(y.jsx)("b",{className:N.a.greyText,children:this.state.robot_current_state.user})]}),Object(y.jsx)("div",{className:N.a.statusBox,children:Object(y.jsx)("b",{className:N.a.statusText,children:"Map:"})}),Object(y.jsxs)("div",{className:N.a.togglePane,children:[Object(y.jsx)("div",{children:"Beautified"}),Object(y.jsx)("div",{className:0===this.state.maptype?"".concat(N.a.toggleButton):"".concat(N.a.toggleButton," ").concat(N.a.right),onMouseDown:function(t){return t.preventDefault()},onClick:function(){t.setState({maptype:1-t.state.maptype})},children:Object(y.jsx)("div",{className:N.a.toggleDot})}),Object(y.jsx)("div",{children:"Occupancy"})]}),0===this.state.maptype?Object(y.jsxs)("div",{onMouseDown:function(t){return t.preventDefault()},className:N.a.Beautifulmap,onClick:this.clickMap,children:[Object(y.jsx)("img",{src:T}),this.renderInsideMap()]}):Object(y.jsxs)("div",{onMouseDown:function(t){return t.preventDefault()},className:N.a.Beautifulmap,onClick:this.clickMap,children:[Object(y.jsx)("img",{src:this.state.occupancy_map}),this.renderInsideMap()]})]}),Object(y.jsxs)("div",{className:N.a.debug2,children:[Object(y.jsx)("div",{className:N.a.secHead,children:"Robot Control"}),this.controlpanel()]})]})]})}}]),a}(n.a.Component),B=Object(i.f)(P);function S(){return Object(y.jsx)(o.a,{children:Object(y.jsxs)(i.c,{children:[Object(y.jsx)(i.a,{path:"/robot",children:Object(y.jsx)(B,{})}),Object(y.jsx)(i.a,{path:"/",children:Object(y.jsx)(v,{})})]})})}var M=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,97)).then((function(e){var a=e.getCLS,s=e.getFID,n=e.getFCP,c=e.getLCP,r=e.getTTFB;a(t),s(t),n(t),c(t),r(t)}))};a(95);r.a.render(Object(y.jsx)(n.a.StrictMode,{children:Object(y.jsx)(S,{})}),document.getElementById("root")),M()}},[[96,1,2]]]);
//# sourceMappingURL=main.e38ce966.chunk.js.map